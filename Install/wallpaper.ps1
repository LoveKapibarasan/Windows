# 色（R,G,B）を指定
# Blue
$r=0;$g=0;$b=255

# BMP の保存先
$out = "$env:USERPROFILE\solidcolor.bmp"

# 1x1 BMP を生成
[byte[]]$bmp = (
0x42,0x4D,0x3E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x36,0x00,0x00,0x00,0x28,0x00,0x00,0x00,0x01,0x00,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x18,0x00,0x00,0x00,0x00,0x00,
0x08,0x00,0x00,0x00,0x13,0x0B,0x00,0x00,0x13,0x0B,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, $b, $g, $r
)
[IO.File]::WriteAllBytes($out, $bmp)

# 壁紙に設定
Set-ItemProperty "HKCU:\Control Panel\Desktop" wallpaper $out
rundll32.exe user32.dll,UpdatePerUserSystemParameters

# Check
Test-Path "$env:USERPROFILE\solidcolor.bmp"
Get-ItemProperty "HKCU:\Control Panel\Desktop" wallpaper

# Reload explorer
Stop-Process -Name explorer -Force
Start-Process explorer
